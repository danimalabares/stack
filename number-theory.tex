\input{preamble}

\begin{document}

\title{Number theory}
\maketitle

\phantomsection
\label{section-phantom}
\hfill
\href{http://github.com/danimalabares/stack}{github.com/danimalabares/stack}

\tableofcontents

\section{Greatest common divisor and least common multiple}
\label{section-gcd-and-lcm}

Following is the universal definition of lcm and gdc:

\begin{definition}
\label{definition-lcm-and-gdc-universal}
A {\it least common multiple} of $a,b \in R$ is an element $d$ such that if for
every $c\in R$, if $a,b|c$ then $d|c$.

A {\it greatest common divisor} of $a,b \in R$ is an element $d$ such that
for every  $c \in R$,  if $c|a,b$ then  $c|d$.
\end{definition}

But it looks like it shall be easier to define them
as follows:

\begin{definition}
\label{definition-lcm-and-gdc-polynomial}
A {\it least common multiple} of $f,g \in R[x]$ is the monic polynomial $d$ of
smallest degree such that $f,g|d$.

A {\it greatest common divisor} of $f,g\in R[x]$ is the monic polynomial $d$ of
greatest degree such that $d|f,g$.
\end{definition}

\begin{lemma}
\label{lemma-existence-of-lcm-and-gcd}
If $R$ is a UFD, in $R[x]$ there exist lcm and mcd, and are unique up to 
multiplication by units.
\end{lemma}

\begin{proof}
We can order by degree, and those of the same degree order by the leading
term… but this requires an order in $R$.
\end{proof}

\section{Unique factorization domains and the Gauss lemma}
\label{section-UFD}

The point of the Gauss lemma is that a polynomial $f$ over the field of fractions
$F$ of a UFD $R$ can be expressed as a rational number called the content of $f$
times a polynomial over $R$ called the primitive part. The point of the Gauss
lemma is that it allows us to make sure that the content will in fact be an
element of $R$.

\medskip\noindent
The following lemma shows that in UFDs irreducibles are primes, but this is not
true in general. (Counterexample in $\mathbb{Z}[\sqrt{-5}]$.)

\begin{lemma}
\label{lemma-irreducible-is-prime}
If $R$ is a UFD then irreducible elements are prime.
\end{lemma}

\begin{proof}
If $f$ is irreducible and $f|ab$ then $f$ must be an element of the unique
factorization of $a$ or $b$.
\end{proof}

In fact, showing that irreducibles are prime would be enough for our purpose of
showing that $F[x]$ is a UFD when $F$ is a field. We shall be able to prove this
(without the assumption of UFD as above) via Bachet-Bézout theorem; which we
state first in its version for integer numbers:

\begin{theorem}[Bachet-Bézout for integers]
\label{theorem-Bachet-Bezout-for-integers}
\begin{reference}
\cite[Theorem 1.7]{MMST}
\end{reference}
Let $a,b \in \mathbb{Z}$ (what is the essential property of $\mathbb{Z}$ that
makes this true?). Then
there exist $x,y \in \mathbb{Z}$ with
 $$
ax+by=\text{gcd}(a,b)
$$
Therefore, if $c \in \mathbb{Z}$ divides both $a$ and $b$ then $c$ divides
$\text{gcd}(a,b)$ as well.
\end{theorem}

\begin{lemma}
\label{lemma-relatively-prime-and-divides-implies-divides}
Let $a,b,c \in \mathbb{Z}$. If $a|bc$ and $(a,b)=1$, then $a|c$.
\end{lemma}

\begin{proof}
By Theorem \ref{theorem-Bachet-Bezout-for-integers}, 
there exist elements $p,q$ such
that $ap+bq=1\implies apc+bcq=c$, so that $a$ divides both summands and thus
divides $c$.
\end{proof}

\begin{theorem}[Division algorithm for polynomials]
\label{theorem-division-algoritm-for-polynomials}
\begin{reference}
\cite[Theorem 1.48]{MMST}
\end{reference}
Let $F$ be a field. Given two polynomials $f,g \in F[x]$ there are two unique
$q,r \in F[x]$ such that
$$
f=qg+r,\qquad \text{deg}r<\text{deg}g.
$$
{\bf Remark.} We use the hypothesis that $F$ is a field to take a fraction with
denominator the leading coefficient of $g$; that is, the theorem is valid if the
leading coefficient of $g$ is a unit.
\end{theorem}

\begin{proof}
We may suppose that $\text{deg}f \geq \text{deg}g$ for if not we just pick
$q=0$ and $r=f$. Now we use induction. 
If $\text{deg}f=\text{deg}g=0$ then $f$ and $g$ are numbers and the result is
obvious since $F$ is a field.

If $\text{deg}f>0$ we do as follows. Suppose $\text{deg}f=n$ and
$\text{deg}g=m$. Write $f(x)=a_nx^n+f_1(x)$ and $g(x)=b_mx^m+g_1(x)$. Notice
that
$$
\frac{a_nx^n}{b_mx^m}g(x)=a_nx^n+\frac{a_n}{b_m}x^{n-m}g_1(x)
$$
so that $f(x)-\frac{a_n}{b_m}x^{n-m}g(x)=f_1(x)-\frac{a_n}{b_m}x^{n-m}g_1(x)$.
This is a polynomial of strictly less degree than that of $f$, so that we can
use induction hypothesis to write it as $qg+r$ with $\text{deg}r<m$. Then
$$
f(x)=g(x)\left(q(x)+\frac{a_n}{b_m}x^{n-m}\right)+r(x).
$$
The uniqueness of $q$ and $r$ follows from considering the division  …
\end{proof}

Recall that the greatest common divisor of two polynomials $f$ and $g$ 
is the {\it monic}
polynomial of least degree that divides both $f$ and $g$.

\begin{theorem}[Bachet-Bézout for polynomials over field]
\label{theorem-Bachet-Bezout-for-polynomials-over-field}
\begin{reference}
\cite[Theorem 1.53]{MMST}
\end{reference}
Let $F$ be a field and $f,g\in F[x]$. 
There exist elements  $p,q \in F[x]$ such that $fp+gq=\text{gcd}(f,g)$.
\end{theorem}

\begin{proof}
Consider the set
$$
I:=\{fx+gy:x,y \in F[x]\}.
$$
Let $d=fp+gq$ be the monic polynomial of least degree 
of the form $fx+gy$, for $x,y \in F[x]$.
Notice that the existence of $d$ monic comes from $F$ being a field.
We claim that $d=\text{gcd}(f,g)$. 
Indeed, we first check by division algorithm
that $d$ divides both $f$ and $g$: 
suppose that $f=dq+r$ with $\text{deg}r<\text{deg}d$. 
Then, if $r=f-dq=f(1-xq)-yg$ is not zero, 
dividing by its leading coefficient gives an element in $I$ 
of degree strictly smaller than the degree of $d$, a contradiction.
Thus $r$ is zero. The same argument shows that $d|g$, and we conclude that
Thus $\text{deg}d \leq \text{deg}\text{gcd}(f,g)$. 

Now, since
$\text{gcd}(f,g)$ divides both $f$ and $g$, it divides $d=xf+yg$. (Indeed, if
$c:=\text{gcd}(f,g)$ is such that $ca=f,cb=g$ then $c(ap+bq)=cap+cbq=fp+gq=d$.) 
Thus $\text{deg}d=\text{deg}\text{gcd}(f,g)$, and since both are monic we are
done.
\end{proof}

Finally we obtain

\begin{lemma}
\label{lemma-irreducible-is-prime-in-F[x]}
Let $F$ be a field. Irreducible elements of $F[x]$ are prime. That is, if $f|gh$
then $f|g$ or $f|h$ for any $f,g,h \in F[x]$.
\end{lemma}

\begin{proof}
Let $d=\text{gcd}(f,g)$. Then $dp=f$ and $dq=g$. If $d$ is not $1$ 
we get that $p$ is a unit. Then $gp$ is a multiple by a unit of $g$ which is
divided by $f$: $gp=dpq=fq$. That's good enough.

Now suppose that $d=1$. Then by Bachet-Bézout Theorem
\ref{theorem-Bachet-Bezout-for-polynomials-over-field} 
there are $p,q \in F[x]$ such that $fp+gq=1$. Then $fph+gqh=h$. Since by
hypothesis $f|gh$ we conclude that $f$ divides both summands, so $f|h$.
\end{proof}

Applying this last lemma over and over again we get that if $f|f_1\ldots f_k$
then $f$ must divide $f_i$ for some $i$.

\begin{lemma}
\label{lemma-polynomials-over-fields-are-UFD}
If $F$ is a field then $F[x]$ is a UFD.
\end{lemma}

\begin{proof}
The existence of the factorization is an easy induction on the degree of $f\in
R[x]$. If $f$ has degree zero, then we are done. If $f$ has positive degree and
is irreducible, we are done. If $f$ has positive degree and it is reducible,
i.e. $f=gh$, then both $g$ and $h$ have strictly smaller degree and we may apply
induction hypothesis to obtain a decomposition of each factor into irreducible
elements.

To prove uniqueness suppose that there exists an element in $F[x]$ that admits
more than one factorization in irreducible elements 
up to multiplication by units. Choose $f$ so that
$\text{deg}f$ is minimal among all such elements.

Write two factorizations of $f$ in irreducible elements as 
$f_1\ldots f_k=f_1'\ldots f_\ell'$ . Suppose that the factors are in
ascending order of degree.

We have that $f_1|f_1'\ldots f_{k'}$, so
that $f_1$ must divide some $f_{i'}'$ 
by Lemma \ref{lemma-irreducible-is-prime-in-F[x]}. 
Since $f'_{i'}$ is irreducible and $f_1$ is
not a unit, we conclude that $f_{i'}=f_1 u$ for some unit $u$. In particular
$\text{deg}f_1 =\text{deg}f'_{i'}\geq \text{deg}f'_1$. 
Similarly, $f_1'$ must divide some $f_i$, so that $f'_1=f_i$ and
that $\text{deg}f_1'=\text{deg}f_{i}\geq \text{deg}f_1$. 
Then $\text{deg}f_1=\text{deg}f'_1=\text{deg}f_i=\text{deg}f'_{i'}$. 

Then I thought: I need a common divisor for $f_1\ldots f_k$ and 
$f_1'\ldots f_{k'}'$. So look at the gcd. If it was 1, then this means by
Bachet-Bézout Theorem \ref{theorem-Bachet-Bezout-for-polynomials-over-field}
that there exist polynomials $p,q \in F[x]$ such that
$$
p(\underbrace{f_1,\ldots f_k}_{=f})
+q(\underbrace{f_1'\ldots f_{k'}'}_{=f})=1
$$
which implies that $f \in F$, which in turn
says that $f$ is irreducible (since all elements of $F$ are units and thus
irreducibles), so that there are no factorizations at all.
Then we must suppose that the gcd of the two factorizations has
positive degree. This is just saying that $f_i=f'_{i'}$ for some $i$ and
$i'$.

Then we consider the quotient $f/f_1=f/f_1'$. This means that we apply the
Division Algorithm \ref{theorem-division-algoritm-for-polynomials}
to  $f$ and  $f_1$, and obtain two quotients with reminder
zero, which by uniqueness of the Division Algorithm gives the equality
$f_2\ldots f_k=f_2'\ldots f_{k'}'$.
This quotient has degree strictly less than $\text{deg} f$ and has two distinct
factorizations in irreducibles. Since $f$ is minimal among all
elements that admit more than one factorization, we conclude that $k=k'$ and
$f_i=f'_i$ for all $i$.
\end{proof}

\begin{remark}
\label{remark-not-the-same-as-in-Z}
Notice that the proof given for integers does not work identically,
for in this case we cannot conclude that $f_1=f_1'$ directly from putting the
factors in order of degree (we can conclude that they have the same degree, but
not that they arr the same polynomial!).
\end{remark}

\medskip\noindent
The true definition of content can be done in three steps:
\begin{definition}
\label{definition-content}
\begin{reference}
\cite[p. 181]{Lang-algebra}
\end{reference}
\begin{enumerate}
\item (Order of a fraction $a$ at a prime $p$.) 
Let $a \in F$. If $p \in R$ is irreducible, the {\it order} of $a$ at $p$
to be the number $r$ such that $a=p^rb$ for some fraction $b$ that does not have
$p$ as factor in the numerator nor in the denominator. (To understand the point
of the Gauss lemma, notice that the order
can be a fraction, i.e. if $p$ is a factor of the denominator.)
\item (Order of a polynomial $f \in F[x]$ at a prime $p$.) 
The {\it  order of $f\in F[x]$ at $p$} is the minimium order of
$p$ in any of the coefficients of $f$. (Defining this number as the {\bf
minimum} ensures that the primitive part of $f$ (see below) has all coefficients
in $R$. It also follows that the gcd of the 
coefficients of the primitive part is 1.)
\item (Content of $f \in F[x]$) The {\it content} of $f$ is the product
of every irreducible factor $p$ of $f$ raised to its order.
\item (Primitive polynomial.) A polynomial is
called {\it primitive} if it has content 1.
\end{enumerate}
\end{definition}

As explained in the beginning of this section, the point of the Gauss
lemma is that it will allow us to make sure that the content of $f$ is an
element of $R$, i.e. not a fraction.

Also, in the definition of order of a fraction $a$ at a prime $p$, notice
 the order well-defined, i.e. unique, by the uniqueness of the factorization
in $R$.

\begin{lemma}[True Gauss lemma]
\label{lemma-true-Gauss}
\begin{reference}
\cite{Chapter 4, Theorem 2.1}{Lang-algebra}
\end{reference}
Let $R$ be a UFD and $F$ its fraction field. Let $f,g\in F[x]$. Then the
$\text{cont}(fg)=\text{cont}(f)\text{cont}(g)$.
\end{lemma}

This clearly implies that the product of two primitive polynomials being
primitive, and the converse I think is true as well.

\begin{proof}
Since $\text{cont}(bf)=b\text{cont}(f)$ it's enough to suppose that  $f$ and $g$
are primitive. Indeed, taking content of $fg$ we obtain on one hand
$\text{cont}(fg)$ and on the other hand
$\text{cont}(\text{cont}(f)\text{pp}(f)\text{cont}(g)\text{pp}(g))
=\text{cont}(f)\text{cont}(g)\text{cont}(\text{pp}(f)\text{pp}(g))$. 
Thus we would finish if we show that the product of two primitive polynomials is
primitive.

Put another way, it's enough to show will show that if $f,g$ are primitive (as
are the primitive parts of $f$ and $g$ in the preceding paragraph) then $fg$ is
primitive. This means that I will show that any $p$ is not a factor of all the
coefficients in $fg$. A coefficient of $fg$ looks as
$c_j=\sum_{i=0}^ja_ib_{j-i}$.  Since $f,g$ are primitive then $p$ cannot divide
all $a_i$ and all $b_i$.  Thus we can pick the maximum $a_s$ and the maximum
$b_t$ that $p$ does not divide. Then the $c_j$ containing the product $a_sb_t$
will not be divided by $p$, for $p$ cannot divide $a_sb_t$ because it is prime,
but will divide the remaining terms in the sum $c_j$; thus if $p$ divided $c_j$
it would also divide $a_sb_t$lmail.
\end{proof}

\begin{lemma}[Gauss]
\label{lemma-R-UFD-implies-R[x]-UFD}
\begin{reference}
\cite[Chapter 4, Theorem 2.3]{Lang-algebra}
\end{reference}
If $R$ is a UFD then $R[x]$ is a UFD.
\end{lemma}

\begin{proof}
Let $f\in R[x]$ be distinct from 0. Since $F[x]$ is UFD we can write
$f=f_1\ldots f_k$. Notice that the primitive parts of the $f_i$ coincide
with the primitive part of the product $f_1\ldots f_k$ by
the Gauss Lemma: 
\begin{align*}
f&=c(f_1\ldots f_k)\text{pp}(f_1\ldots f_k),\\
f&=c(f_1)\text{pp}(f_1)\ldots c(f_k)\text{pp}(f_k)
\end{align*}
and we cancel the content part dividing (using that we are in a field) by the
Gauss Lemma.

We also apply the Gauss Lemma to conclude that
$c(f)=c(f_1)\ldots c(f_k)$, being the content of a polynomial with coefficients
in $R$, must be in $R$ as well, so that we can decompose it as a product of
irreducibles since $R$ is a UFD.

To obtain a factorization in irreducibles we only need to show that each of the
$\text{pp}(f_i)$ is irreducible in $R[x]$.
To see this suppose that 
$\text{pp}(f_i)=gh$. $c(f_i)\text{pp}(f_i)=f_i$ is irreducible
in $F[x]$, so either $c(f_i)g$ or $h$ is a unit of $F$. Then 
either $g$ or $h$ are in $R$. But the gcd of 
the coefficients of $\text{pp}(f_i)$ is 1, so, since we have factored
an element of $R$ from $\text{pp}(f_i)$, it must be 1.

The uniqueness of the factorization follows from the uniqueness of the
factorization in $F[x]$, for another factorization in $R[x]$ would be a
factorization in $F[x]$, making the number of factors the same,
and equality of the factorizations up
to a fraction $u$,
which is a unit of $F[x]$. We just need to make sure $u$ is a unit of $R$.
Write uniqueness of the factorization in $F[x]$ as: 
$f_1=uf_1'$ and $f_i=f_i'$ for $i\neq 1$.
It is clear that $u \in R$, since otherwise $f_1$ couldn't
be a polynomial in $R[x]$. But since $f_1$ is irreducible in $R$ and $f_1$ 
is not a unit (of $R$), we conclude that $u$ is a unit of $R$.
\end{proof}

\begin{lemma}
\label{lemma-in-UFD-irreducible-elements-generate-prime-ideals}
In a UFD, irreducible elements generate prime ideals.
\end{lemma}

\begin{proof}
Let $f$ be irreducible. Suppose that $pq\in(f)$. Then $pq=fg$ for some  $g\in
R$. Then $p_1\ldots p_kq_1\ldots q_\ell=fg_1\ldots g_m$. But since $f$ is
irreducible and factorization is unique we conclude that $f$ must be one of the
 $p_i$ or one of the $q_i$. Then $f$ divides $p$ or $q$, i.e. either $p\in(f)$
or $q\in(f)$.
\end{proof}

\section{Unique factorization domains (alternative approach)}
\label{section-UFD-alternative}


\begin{lemma}
\label{lemma-primitive-part-unique-up-to-unit}
$\text{pp}(f)$ is unique up to multiplication by unit.
\end{lemma}

\begin{proof}
This follows from uniqueness up to units of gdc and lcm.
\end{proof}

\begin{definition}
\label{definition-primitive-part}
If $f\in F[x]$, define its {\it primitive part} to be a primitive polynomial
$\text{pp}(f)$ such that $c\text{pp}(f)=df$ where
\begin{itemize}
\item $d\in R$ is the minimum common
factor of the denominators of the coefficients of $f$, which may be defined as
the product of the least elements among all the factors (in their unique
factorization) of the denominators such that $df \in R[x]$.
\item $c\in R$ is the greatest common divisor of the coefficients of $df$, which
may be defined as the product of the greatest number of common elements in the
factorizations of each of the coefficients in $df$.
\end{itemize}
\end{definition}

\begin{lemma}[Gauss]
\label{lemma-Gauss}
Let $R$ be a ring and $F$ its field of fractions. A primitive polynomial $f\in
R[x]$ is irreducible in $F[x]$ if and only if it is irreducible in $R[x]$.
\end{lemma}

\begin{proof}
The direct implication is easy: suppose $f$ is irreducible in $F[x]$ and let
$f=gh$ for $g,h\in R[x]$. Then $g,h$ are also in $F[x]$ so that either of them
must be a unit of $F$, i.e. a fraction. But since they are polynomials in
$R[x]$, then it must be an element of $R$. But since $f$ is primitive we obtain
a contradiction unless the number is a unit.

For the converse, suppose that $f$ is irreducible in $R[x]$. To obtain a 
contradiction suppose that $f=gh$ in $F[x]$ with $g,h$ not units in $F[x]$.
Then $f=c\text{pp}(f)=c\text{pp}(g)\text{pp}(h)$ by the True Gauss lemma. 
Notice that we cannot take primitive parts of $g$ and $h$ separately since this
would give perhaps rational contents.
\end{proof}

\begin{lemma}
\label{lemma-irreducible-in-Fx-implies-primitive-part-irreducible}
If $f\in F[x]$ is irreducible (in $F[x]$), then its primitive part
$\text{pp}(f)$ is irreducible in $R[x]$.
\end{lemma}

\begin{proof}
Suppose that $\text{pp}(f)=gh$ for two non-unit polynomials $g,h\in F[x]$.
Multiplying by $c$ as in Definition \ref{definition-primitive-part} we obtain
$c\text{pp}(f)=cgh \implies df=cgh \implies f=\frac{c}{d}gh$, a contradiction
since $f$ is irreducible in $F[x]$. This shows that
$\text{pp}(f)$ is irreducible in $F[x]$. By Gauss lemma, since $\text{pp}(f)$ is
irreducible in $F[x]$ and primitive, it must be irreducible in $R[x]$.
\end{proof}

\begin{lemma}
\label{lemma-Gauss-lemma-corollary}
If $R$ then $R[x]$ is a UFD.
\end{lemma}

\begin{proof}
Let $f\in R[x]$. Let $c$ be the greatest common divisor of the coefficients of
$f$, so that $f=cf'$. Factor $f'$ in $F[x]$ as $f'=f_1'\ldots f_k'$. Take
primitive parts to write $f=c'\text{pp}(f_1')\ldots \text{pp}(f_k')$. By Lemma
\ref{lemma-irreducible-in-Fx-implies-primitive-part-irreducible} each of the
$\text{pp}(f_i')$ is primitive in $R[x]$. By the True Gauss lemma we get that
$c'=c\in R$. Since $R$ is a UFD we also obtain that
$c'$ may be factored into irreducible elements of $R$, which are also
irreducible in $R[x]$.

Uniqueness of the factorization follows from uniqueness of the factorization in
$F[x]$ and Gauss lemma: suppose that $f$ may also be factored into irreducible
elements of $R[x]$ as $g_1\ldots g_\ell$. We wish to show that this is a
factorization in irreducible elements of $F[x]$, which we know to be unique up
to multiplication by units of $F$. To show this we use the converse implication
of Gauss lemma \ref{lemma-Gauss}: after taking primitive parts to obtain
$\text{pp}(g_i)$, which are irreducible and primitive elements of $R[x]$, which
must be irreducible in $F[x]$. Then $i=\ell$, the constants coincide and
$\text{pp}(g_i)=\text{pp}(f_i)$. Since taking primitive part is unique up to
multiplication by unit, we are done.

By induction on the degree of $f \in R[x]$. Write $f=cf'$ for
$c=\text{gcd}(\text{coefficients of $f$})$. Then I claim that $f=cf'$ is a
factorization of $f$ into irreducible elements. $f'$ is irreducible because it
is linear and primitive; that is, writing $f'=c'f''$ is impossible because
there is no way to factor a non-unit number from the coefficients of $f'$;
indeed, in such case, $cc'$ would be a {\it larger} common factor of $f$. Here I
define larger as follows using that $R$ is UFD: if $a=a_1\ldots a_k$ and
$b=b_1\ldots b_\ell$ then the gdc is the product of all common factors of $a$
and $b$.

To conclude our induction now suppose that degree-$n$ elements have
factorization and let $f$ be of degree $n+1$. If $f$ is irreducible we are done.
Otherwise $f$ can be expressed as the product of two positive degree elements,
each of which is expressed in a product of irreducibles.
\end{proof}


\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

